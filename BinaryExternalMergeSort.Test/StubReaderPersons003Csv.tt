<#@ template debug="false" hostspecific="true" language="C#" #>
<#@ assembly name="System.Core" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ import namespace="System.IO" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Text" #>
<#@ output extension=".cs" #>
namespace BinaryExternalMergeSort.Test;

internal sealed class StubReaderPersons003Csv : StubReaderBase
{
    public StubReaderPersons003Csv() : base([
<#
IServiceProvider host = (IServiceProvider)Host;
EnvDTE.DTE dte = (EnvDTE.DTE)host.GetService(typeof(EnvDTE.DTE));

string file = Path.Combine(dte.ActiveDocument.Path, "persons_003.csv");

List<string> byteStrs = File
	.ReadAllBytes(file)
	.Select(a => $"0x{a:X2}")
	.ToList();

int i = 0;
for (; i < byteStrs.Count - 1; i++)
	byteStrs[i] = byteStrs[i] + ", ";

byteStrs[i] = byteStrs[i] + "])";

var lines = new List<string>();
var line = new StringBuilder();
i = 0;
foreach (var byteStr in byteStrs)
{
	line.Append(byteStr);
	i += byteStr.Length;
	if (i > 70)
	{
		i = 0;
		lines.Add(line.ToString());
		line.Clear();
	}
}
lines.Add(line.ToString());
line.Clear();

foreach (var a in lines)
{
#>
        <#= a #>
<#
}
#>
    {
    }
}